{{ define "main" }}
    {{- partial "page/main-content" . -}}

    <!--
    <div x-data="RMST_TS.createPickster()">
        <div class="grid grid-cols-7 grid-rows-8 bg-gray-200 p-2 gap-1">
            <div class="col-span-1 bg-white" @click="calendarDates.back()">
                {{ partial "heroicons/solid/chevron-left.svg" "is-icon is-1em"}}
            </div>
            <div class="col-span-5 text-center bg-white">
                <span x-text="calendarDates.headers.headline"></span>
            </div>
            <div class="col-span-1 text-right bg-white" @click="calendarDates.forward()">
                {{ partial "heroicons/solid/chevron-right.svg" "is-icon is-1em"}}
            </div>
            <template x-for="day in calendarDates.headers.days">
                <div x-text="day" class="font-bold bg-white"></div>
            </template>
            <template x-for="Day in calendarDates.calendarCells">
                <div x-text="Day.dayInMonth" class="bg-white"></div>
            </template>
        </div>
    </div>
    -->


    <div
        data-role="event-list"
        id="dance-event-list"
        class="grid grid-cols-12 gap-4 grid"
        x-data="RMST_TS.danceEventPageFacade()"
        x-init="function() {
            list.init();
            filters.init();
            $watch('filters.searchQuery', val => handleFilterChange(val));
        }"
    >

    <div class="col-span-8">
        <div
            x-show="list.isLoading" x-transition
            class=" h-64 min-h-screen flex flex-col items-center border-gray-300 border-dashed border-4 rounded-sm pt-12"
        >
            <div class="is-sticky-on-side animate-pulse">
                <div class="mb-5 inline-block px-4 py-2 text-gray-50 font-bold bg-gray-600 rounded-lg">Wird geladen</div>
                <div class="flex items-center justify-center space-x-2 is-tripple-dots">
                    <div class="w-4 h-4 bg-gray-600 rounded-full is-dot"></div>
                    <div class="w-4 h-4 bg-gray-600 rounded-full is-dot"></div>
                    <div class="w-4 h-4 bg-gray-600 rounded-full is-dot"></div>
                </div>
            </div>
        </div>

        <div
            x-transition x-show="!list.isLoading"
            class="col-span-8"
        >
            <template x-for="date in list.dates">
                <div class="px-0  mb-12 last:mb-0">
                    <h1
                        class="text-xl font-bold px-2 py-1 border- mb-2 border-t-4 border-gray-200 border-dashed"
                        x-text="date"
                    ></h1>
                    <template x-for="event in list.getEventsByDate(date)">
                        <div class="h-full flex flex-col text-sm is-card" x-data="{notepad: RMST_TS.notepad, additional: null}">
                            <h1 class="text-lg bold font-bold">
                                <span x-text="event.summary"></span>
                            </h1>
                            <div class="my-2">
                                <span
                                    class="rounded-sm px-1 inline-block border text-white text-sm"
                                    :class="
                                        event.category === 'socials'
                                        ? 'bg-red-600 border-red-400'
                                        : 'bg-blue-600 border-blue-400'
                                    "
                                >
                                    <span x-show="event.isSocial">
                                        {{ i18n "event-category-socials"}}
                                    </span>
                                    <span x-show="event.isClass">
                                        {{ i18n "event-category-class"}}
                                    </span>
                                </span>
                            </div>
                            <div class="mb-3">
                                <div class="flex flex-row gap-2">
                                    <div>
                                        {{ partial "heroicons/outline/calendar.svg" "is-icon is-base"}}
                                        <span x-text="event.startDateLocalized"></span>
                                    </div>
                                    <div>
                                        {{ partial "heroicons/outline/clock.svg" "is-icon is-base"}}
                                        <span x-text="event.startTimeLocalized"></span>
                                        &ndash;
                                        <template x-if="event.isLong">
                                            <span x-text="event.endDateLocalized"></span>
                                        </template>
                                        <span x-text="event.endTimeLocalized"></span>
                                        Uhr
                                    </div>
                                </div>
                                <div class="flex flex-row">
                                    <div class="pr-1">
                                        {{ partial "heroicons/outline/location-marker.svg" "is-icon is-base"}}
                                    </div>
                                    <div x-html="event.location"></div>
                                </div>
                            </div>
                            <div class="text-right mt-auto flex flex-row justify-end gap-2">
                                <a
                                    href="#"
                                    class="is-button"
                                    @click.prevent="additional = list.handleAdditional(additional, 'share')"
                                >
                                    {{ partial "heroicons/outline/share.svg" "is-icon is-base"}}
                                    {{ i18n "event-share" }}
                                </a>
                                <a href="#" class="is-button" @click.prevent="notepad.toggle(event)">
                                    <template x-if="!notepad.isSaved(event)">
                                        <span>
                                            {{ partial "heroicons/outline/heart.svg" "is-icon is-base"}}
                                            {{ i18n "event-is-not-saved" }}
                                        </span>
                                    </template>
                                    <template x-if="notepad.isSaved(event)">
                                        <span>
                                            {{ partial "heroicons/solid/heart.svg" "is-icon is-base text-red-500"}}
                                            {{ i18n "event-is-saved" }}
                                        </span>
                                    </template>
                                </a>
                                <a href="#" class="is-button" @click.prevent="additional = list.handleAdditional(additional, 'more')">
                                    {{ i18n "event-more-information" }}
                                    {{ partial "heroicons/outline/chevron-double-right.svg" "is-sm icon" }}
                                </a>
                            </div>
                            <template x-if="additional !== null">
                                <div class="additional bg-gray-50 border-t-2 border-dashed -mx-4 -mb-4 px-4 py-4 mt-4">
                                    <template x-if="additional === 'more'">
                                        <!-- More -->
                                        <div class="inner">
                                            <h4 class="font-bold text-lg">{{ i18n "event-headline-description" }}</h4>
                                            <div class="prose" x-html="event.description"></div>
                                            <div class="flex flex-row flex-wrap gap-4">
                                                <div>
                                                    <h4 class="font-bold text-lg">{{ i18n "event-headline-location" }}</h4>
                                                    <div x-html="event.locationHtml"></div>
                                                    <a
                                                        class="underline"
                                                        target="_blank"
                                                        :href="event.mapsLink"
                                                    >
                                                        {{ partial "heroicons/solid/location-marker.svg" "is-icon is-1em" }}
                                                        {{ i18n "event-directions"}}
                                                    </a>
                                                </div>
                                                <div>
                                                    <h4 class="font-bold text-lg">{{ i18n "event-headline-time" }}</h4>
                                                    <div>
                                                        <div>
                                                            {{ partial "heroicons/outline/calendar.svg" "is-icon is-base"}}
                                                            <span x-text="event.startDateLocalized"></span>
                                                        </div>
                                                        <div>
                                                            {{ partial "heroicons/outline/clock.svg" "is-icon is-base"}}
                                                            <span x-text="event.startTimeLocalized"></span>
                                                            &ndash;
                                                            <template x-if="event.isLong">
                                                                <span x-text="event.endDateLocalized"></span>
                                                            </template>
                                                            <span x-text="event.endTimeLocalized"></span>
                                                            Uhr
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </template>
                                    <!-- Share -->
                                    <template x-if="additional === 'share'">
                                        <div class="grid grid-cols-2 gap-2">
                                            <div>
                                                <h4 class="font-bold text-lg">
                                                    Scan & Go
                                                </h4>
                                                <canvas
                                                    class="w-max-auto max-w-full h-auto"
                                                    :id="'dance-event-qr-'+ event.id"
                                                    x-init="list.generateQrCode(event)"
                                                ></canvas>
                                            </div>
                                            <div>
                                                links
                                            </div>
                                        </div>
                                    </template>
                                </div>
                            </template>
                        </div>
                    </template>
                </div>
            </template>
            <template x-if="list.initialized">
                <template x-if="list.showLoader">
                    <div
                        x-intersect:enter="list.loadMore()"
                        class=""
                    >
                        <div class="flex items-center justify-center space-x-2 animate-bounce">
                            <div class="w-4 h-4 bg-red-400 rounded-full"></div>
                            <div class="w-4 h-4 bg-red-400 rounded-full"></div>
                            <div class="w-4 h-4 bg-red-400 rounded-full"></div>
                        </div>
                    </div>
                </template>
                <template x-if="!list.showLoader">
                    <div>
                        Mehr hamma nich!
                    </div>
                </template>
            </template>
        </div>
    </div>
    {{ partial "events/filter-bar.html" . }}
    </div>

{{ end }}